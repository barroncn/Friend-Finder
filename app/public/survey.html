<!DOCTYPE html>
<html lang="en-us">
    <head>
        <title>Friend Finder Home</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
        <link href="https://fonts.googleapis.com/css?family=Archivo+Black|Fredoka+One|Assistant" rel="stylesheet">
        <link rel="stylesheet" href="./css/style.css" type="text/css" />
        <script src="https://use.fontawesome.com/8bd2ed03e6.js"></script>
        <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    </head>
    <body>
        <div class="container">
          <div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true"id="matchModal">
              <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h3 class="modal-title" id="modalTitle">   Friend Found: Your best match is <span id="matchName" style="font-weight:bold"></span>!</h3>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <p id="matchPic"></p>
                    <br>
                  </div>
                  <div class="modal-footer">
                  </div>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="card-header round">
                <h3>Survey Questions</h3>
              </div>
              <div class="card-block">
                <h5 class="card-title">About You</h5>
                <form method="POST" id="theForm">
                  <div class="form-group">
                    <label class="ques" for="name" >Name <span class="text-muted">(Required)</span></label>
                    <input type="name" class="form-control" id="userName" aria-describedby="emailHelp" placeholder="">
                    <small id="emailHelp" class="form-text text-muted"></small>
                  </div>
                  <div class="form-group">
                    <label class="ques" for="photoLink" >Link to Photo Image <span class="text-muted">(Required)</span></label>
                    <input type="input" class="form-control" placeholder="" id="userImage">
                  </div>
                  <hr>
                  <div class="form-group">
                    <label for="exampleSelect1"><h5>Question 1</h5></label>
                    <p class="ques" class="form-text ">Your're glad Donald Trump is president.</p>
                    <div class="dropdown">
                      <button class="btn btn-secondary dropdown-toggle text-muted" type="button" id="q1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Select an Option
                      </button>
                      <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                        <button class="dropdown-item" type="button" value="1">1 (strongly agree)</button>
                        <button class="dropdown-item" type="button" value="2">2 (somewhat agree)</button>
                        <button class="dropdown-item" type="button" value="3">3 (neutral)</button>
                        <button class="dropdown-item" type="button" value="4">4 (somewhat disagree)</button>
                        <button class="dropdown-item" type="button" value="5">5 (strongly disagree)</button>
                      </div>
                    </div>
                  </div>
                  <br>
                  <div class="form-group">
                    <label for="exampleSelect1"><h5>Question 2</h5></label>
                    <p class="ques" class="form-text ">You care more about being polite and making people feel comfortable than you do about letting everyone know your opinion.</p>
                    <div class="dropdown">
                      <button class="btn btn-secondary dropdown-toggle text-muted" type="button" id="q2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Select an Option
                      </button>
                      <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                       <button class="dropdown-item" type="button" value="1">1 (strongly agree)</button>
                        <button class="dropdown-item" type="button" value="2">2 (somewhat agree)</button>
                        <button class="dropdown-item" type="button" value="3">3 (neutral)</button>
                        <button class="dropdown-item" type="button" value="4">4 (somewhat disagree)</button>
                        <button class="dropdown-item" type="button" value="5">5 (strongly disagree)</button>
                      </div>
                    </div>
                  </div>
                  <br>
                  <div class="form-group">
                    <label for="exampleSelect1"><h5>Question 3</h5></label>
                    <p class="ques" class="form-text ">You would rather visit a museum than a sporting event.</p>
                    <div class="dropdown">
                      <button class="btn btn-secondary dropdown-toggle text-muted" type="button" id="q3" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Select an Option
                      </button>
                      <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                        <button class="dropdown-item" type="button" value="1">1 (strongly agree)</button>
                        <button class="dropdown-item" type="button" value="2">2 (somewhat agree)</button>
                        <button class="dropdown-item" type="button" value="3">3 (neutral)</button>
                        <button class="dropdown-item" type="button" value="4">4 (somewhat disagree)</button>
                        <button class="dropdown-item" type="button" value="5">5 (strongly disagree)</button>
                      </div>
                    </div>
                  </div>
                  <br>
                  <div class="form-group">
                    <label for="exampleSelect1"><h5>Question 4</h5></label>
                    <p class="ques" class="form-text ">You would rather go shopping than go for a hike.</p>
                    <div class="dropdown">
                      <button class="btn btn-secondary dropdown-toggle text-muted" type="button" id="q4" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Select an Option
                      </button>
                      <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                        <button class="dropdown-item" type="button" value="1">1 (strongly agree)</button>
                        <button class="dropdown-item" type="button" value="2">2 (somewhat agree)</button>
                        <button class="dropdown-item" type="button" value="3">3 (neutral)</button>
                        <button class="dropdown-item" type="button" value="4">4 (somewhat disagree)</button>
                        <button class="dropdown-item" type="button" value="5">5 (strongly disagree)</button>
                      </div>
                    </div>
                  </div>
                  <br>
                  <div class="form-group">
                    <label for="exampleSelect1"><h5>Question 5</h5></label>
                    <p class="ques" class="form-text ">You would rather cook a meal than go to a fancy dinner.</p>
                    <div class="dropdown">
                      <button class="btn btn-secondary dropdown-toggle text-muted" type="button" id="q5" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Select an Option
                      </button>
                      <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                        <button class="dropdown-item" type="button" value="1">1 (strongly agree)</button>
                        <button class="dropdown-item" type="button" value="2">2 (somewhat agree)</button>
                        <button class="dropdown-item" type="button" value="3">3 (neutral)</button>
                        <button class="dropdown-item" type="button" value="4">4 (somewhat disagree)</button>
                        <button class="dropdown-item" type="button" value="5">5 (strongly disagree)</button>
                      </div>
                    </div>
                  </div>
                  <br>
                  <div class="form-group">
                    <label for="exampleSelect1"><h5>Question 6</h5></label>
                    <p class="ques" class="form-text ">You would rather spend your money on nice things than spend it on experiences.</p>
                    <div class="dropdown">
                      <button class="btn btn-secondary dropdown-toggle text-muted" type="button" id="q6" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Select an Option
                      </button>
                      <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                        <button class="dropdown-item" type="button" value="1">1 (strongly agree)</button>
                        <button class="dropdown-item" type="button" value="2">2 (somewhat agree)</button>
                        <button class="dropdown-item" type="button" value="3">3 (neutral)</button>
                        <button class="dropdown-item" type="button" value="4">4 (somewhat disagree)</button>
                        <button class="dropdown-item" type="button" value="5">5 (strongly disagree)</button>
                      </div>
                    </div>
                  </div>
                  <br>
                  <div class="form-group">
                    <label for="exampleSelect1"><h5>Question 7</h5></label>
                    <p class="ques" class="form-text ">You are constantly finding new things to learn.</p>
                    <div class="dropdown">
                      <button class="btn btn-secondary dropdown-toggle text-muted" type="button" id="q7" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Select an Option
                      </button>
                      <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                        <button class="dropdown-item" type="button" value="1">1 (strongly agree)</button>
                        <button class="dropdown-item" type="button" value="2">2 (somewhat agree)</button>
                        <button class="dropdown-item" type="button" value="3">3 (neutral)</button>
                        <button class="dropdown-item" type="button" value="4">4 (somewhat disagree)</button>
                        <button class="dropdown-item" type="button" value="5">5 (strongly disagree)</button>
                      </div>
                    </div>
                  </div>
                  <br>
                  <div class="form-group">
                    <label for="exampleSelect1"><h5>Question 8</h5></label>
                    <p class="ques" class="form-text ">You can't stand to let dirty dishes collect in the sink.</p>
                    <div class="dropdown">
                      <button class="btn btn-secondary dropdown-toggle text-muted" type="button" id="q8" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Select an Option
                      </button>
                      <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                        <button class="dropdown-item" type="button" value="1">1 (strongly agree)</button>
                        <button class="dropdown-item" type="button" value="2">2 (somewhat agree)</button>
                        <button class="dropdown-item" type="button" value="3">3 (neutral)</button>
                        <button class="dropdown-item" type="button" value="4">4 (somewhat disagree)</button>
                        <button class="dropdown-item" type="button" value="5">5 (strongly disagree)</button>
                      </div>
                    </div>
                  </div>
                  <br>
                  <div class="form-group">
                    <label for="exampleSelect1"><h5>Question 9</h5></label>
                    <p class="ques" class="form-text ">You think that everyoneâ€™s views should be respected regardless of whether they are supported by facts or not.</p>
                    <div class="dropdown">
                      <button class="btn btn-secondary dropdown-toggle text-muted" type="button" id="q9" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Select an Option
                      </button>
                      <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                        <button class="dropdown-item" type="button" value="1">1 (strongly agree)</button>
                        <button class="dropdown-item" type="button" value="2">2 (somewhat agree)</button>
                        <button class="dropdown-item" type="button" value="3">3 (neutral)</button>
                        <button class="dropdown-item" type="button" value="4">4 (somewhat disagree)</button>
                        <button class="dropdown-item" type="button" value="5">5 (strongly disagree)</button>
                      </div>
                    </div>
                  </div>
                  <br>
                  <div class="form-group">
                    <label for="exampleSelect1"><h5>Question 10</h5></label>
                    <p class="ques" class="form-text ">You feel more energetic after spending time with a group of people.</p>
                    <div class="dropdown">
                      <button class="btn btn-secondary dropdown-toggle text-muted" type="button" id="q10" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        Select an Option
                      </button>
                      <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                        <button class="dropdown-item" type="button" value="1">1 (strongly agree)</button>
                        <button class="dropdown-item" type="button" value="2">2 (somewhat agree)</button>
                        <button class="dropdown-item" type="button" value="3">3 (neutral)</button>
                        <button class="dropdown-item" type="button" value="4">4 (somewhat disagree)</button>
                        <button class="dropdown-item" type="button" value="5">5 (strongly disagree)</button>
                      </div>
                    </div>
                  </div>
                  <br>
                  <button id="submit" type="submit" class="btn btn-primary" style="width:100%"><i class="fa fa-check-circle" aria-hidden="true"></i> Submit</button>
                  <br>
                  <br>
                  <p id="message" style="color:red; text-align:center">Please Complete All Survey Information</p>
                </form>
              </div>
            </div>
            <br>
            <p class="smFont"><a href="/api/friends">API Friends List</a> | <a href="https://github.com/barroncn/friend-finder">GitHub Repo</a></p>
        </div>
        
        <script type="text/javascript">
            //Hide the incomplete input message when the page loads
            $("#message").hide();
            
            //When the user selects an answer, the answer text populates the button
            $(".dropdown-item").click(function(){
                var selText = $(this).text();
                $(this).parents('.dropdown').find('.dropdown-toggle').html(selText+'<span class="caret"></span>');
            });
            
            //When the user clicks the API link, a get request is made to /api/friends
            $("#allAPI").on("click", function(){
                $.get("/api/friends", function(data){})
            });
            
            //When the user clicks submit
            $("#submit").on("click", function(){
              //keep the page from reloading
              event.preventDefault();
              
              //Hide the incomplete entry message (in case they didn't fill out the form correctly on a previous submit click)
              $("#message").hide();
              
              //IF the user has filled out the survey completely (all inputs and dropdowns have been answered)
              if($("#userName").val()!="" && $("#userImage").val()!="" && $("#q1").text()!="Select an Option" && $("#q2").text()!="Select an Option" && $("#q3").text()!="Select an Option" && $("#q4").text()!="Select an Option" && $("#q5").text()!="Select an Option" && $("#q6").text()!="Select an Option" && $("#q7").text()!="Select an Option" && $("#q8").text()!="Select an Option" && $("#q9").text()!="Select an Option" && $("#q10").text()!="Select an Option"){
                
                //Create aNewFriend object in the appropriate format for posting to our api
                var aNewFriend = {
                                  "name":$("#userName").val().trim(),
                                  "photo":$("#userImage").val().trim(),
                                  "scores":[
                                      $("#q1").text()[0], //Takes only the rating digit from the button text (the first index of the text)
                                      $("#q2").text()[0],
                                      $("#q3").text()[0],
                                      $("#q4").text()[0],
                                      $("#q5").text()[0],
                                      $("#q6").text()[0],
                                      $("#q7").text()[0],
                                      $("#q8").text()[0],
                                      $("#q9").text()[0],
                                      $("#q10").text()[0]
                                    ]
                                };
                                
                var sum = 0; //Set the answer choice sum to zero
                
                //loop through aNewFriend scores array to add up the answers choices
                for (var i = 0; i < aNewFriend.scores.length; i++){
                  sum += parseInt(aNewFriend.scores[i]);
                }
                
                aNewFriend.sum = sum; //In the aNewFriend object, set a new key "sum" to the sum of the answer choices
                
                 //Send the aNewFriend object as data in a post request to /api/friends
                 $.post("/api/friends", aNewFriend).done(function(data){//Once the request has been posted, the server will send back the matching friend object as "data" (see apiRoutes.js for how we selected the matching friend as the server's response)
                  $("#matchPic").html("<img width='100%' src="+ data.photo +">"); //Set the match's image as the image in the modal
                  $("#matchName").html(data.name); //Set the match's name as the name in the modal
                  $('#matchModal').modal(); //display the modal
                 });
                 
                 //Reset the Form
                 $("#theForm")[0].reset();
                 $(".dropdown-toggle").text("Select an Option");
              }
              //Advise the user that they must fill out the survey completely
              else{
                $("#message").show();
              }
            });
        </script>
        
        <script type="text/javascript" src="../routing/apiRoutes.js"></script>
        <script type="text/javascript" src="../routing/htmlRoutes.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
    </body>
</html>